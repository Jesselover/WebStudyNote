

1.   `F:\TXJ\wentiku\launch\apache-tomcat-7.0.106\bin\startup.bat` 双击
2.   `F:\TXJ\wentiku\launch\jar包`  cmd  ` java -jar txj-admin.jar `
3.   二期地址  `http://localhost:9080/imis`
4.  `http://192.168.96.180:3000/project/420/interface/api/21375`
5. 进度 https://docs.qq.com/sheet/DVkhqd1lLbmd2RU9u?tab=BB08J2&_t=1705566258712&u=dcbade60186e4aafac6632c39808982b
6. 测试环境访问地址:http://192.168.96.12:8080/imis/logout.do?method=logout

# 页面开发

## 根因分析

-   `isReasonAnalysis` 字段在 `problemTable.vue` 页面中控制是否显示该页面组件

```
周梦玲：txj10808901
曹鹏飞：txj10808245
陈冶卫：txj10203992
封依娴: txj10202507
```
![[Pasted image 20240124153701.png]]

### 根因分析报告组件

```html
      <ReasonAnalysisReport  @cancel="reportCancel"
                            @confirm="reportConfirm" // 自定义事件传值，传给父组件自己的 form ，新增根因分析报告要用
                            
                            :myReportForm="reportForm"  // this.reportForm = data.report ( 查询根因分析报告 queryRootAnalysisReport)
                            :problemType="detailForm.problemType" // row里的问题类型
                            :isDisabled="pageState != 1"> 
      </ReasonAnalysisReport>
```

```html
    <!-- 最后一步处理过程 -->
    <hr />
    <el-form v-if="!processForm.verifyDate"
             :model="processForm"
             status-icon
             hide-required-asterisk
             :inline="true"
             size="mini"
             label-width="100px"
             class="demo-ruleForm"
             style="padding-top: 20px">
      <el-form-item label="处理人"
                    prop="assignName">
        <el-input size="mini"
                  :disabled="isDisabled"
                  v-model="processForm.assignName"
                  placeholder="请输入" />
        <el-input v-show="false"
                  v-model="processForm.assignId" />
      </el-form-item>
      <el-form-item label="处理部门"
                    prop="receiveGroupName">
        <el-input v-model="processForm.receiveGroupName"
                  :disabled="isDisabled"
                  placeholder="请输入" />
        <el-input v-show="false"
                  v-model="processForm.receiveGroupIdId" />
      </el-form-item>
      <el-form-item label="处理时间"
                    prop="solveDate">
        <el-date-picker v-model="processForm.solveDate"
                        :disabled="isDisabled"
                        value-format="yyyy-MM-dd HH:mm:ss"
                        type="datetime"
                        @input="$forceUpdate()"
                        width="200px"
                        size="mini"
                        placeholder="选择日期">
        </el-date-picker>
      </el-form-item>
      <el-form-item label="问题原因描述"
                    class="langItem"
                    prop="problemCause">
        <div class="inputBox">
          <el-input v-model="processForm.problemCause"
                    type="textarea"
                    style="width: 100%"
                    show-word-limit
                    maxlength="1000"
                    :rows="4"
                    disabled />
        </div>
      </el-form-item>
      <el-form-item label="应急解决方案"
                    class="langItem"
                    prop="problemSolution">
        <div class="inputBox">
          <el-input v-model="processForm.problemSolution"
                    type="textarea"
                    style="width: 100%"
                    show-word-limit
                    maxlength="1000"
                    :rows="4"
                    disabled />
        </div>
      </el-form-item>
      <el-form-item label="附件(点击下载)">
        <div class="fileClass">
          <div v-for="(item, index) in processForm.fileInfoList"
               class="fileName"
               @click="downFiles(item)"
               :key="index">
            <template v-if="index == processForm.fileInfoList.length - 1">{{
              item.fileName.substring(0, 9)
            }}</template>
            <template v-else>{{ item.fileName.substring(0, 9) }} </template>
          </div>
        </div>
      </el-form-item>
    </el-form>
    <el-form v-if="processForm.verifyDate"
             :model="processForm"
             status-icon
             hide-required-asterisk
             :inline="true"
             size="mini"
             label-width="100px"
             class="demo-ruleForm"
             style="padding-top: 20px">
      <el-form-item label="验证人"
                    prop="receiverName">
        <el-input size="mini"
                  :disabled="isDisabled"
                  v-model="processForm.assignName"
                  placeholder="请输入" />
        <el-input v-show="false"
                  v-model="processForm.assignId" />
      </el-form-item>
      <el-form-item label="验证方式"
                    prop="verifyPattern">
        <el-select v-model="processForm.verifyPattern"
                   :disabled="isDisabled"
                   size="mini">
          <el-option v-for="dict in verifyPatterns"
                     :key="dict.dictValue"
                     :label="dict.dictLabel"
                     :value="dict.dictValue" />
        </el-select>
      </el-form-item>
      <el-form-item label="验证时间"
                    prop="verifyDate">
        <el-date-picker v-model="processForm.verifyDate"
                        :disabled="isDisabled"
                        value-format="yyyy-MM-dd HH:mm:ss"
                        type="datetime"
                        @input="$forceUpdate()"
                        width="200px"
                        size="mini"
                        placeholder="选择日期">
        </el-date-picker>
      </el-form-item>
      <el-form-item label="验证结果"
                    prop="verifyStatus">
        <el-select v-model="processForm.verifyStatus"
                   :disabled="isDisabled">
          <el-option v-for="dict in verifyStatusOptions"
                     :key="dict.dictValue"
                     :label="dict.dictLabel"
                     :value="dict.dictValue" />
        </el-select>
      </el-form-item>
      <el-form-item label="附件(点击下载)">
        <div class="fileClass">
          <div v-for="(item, index) in processForm.fileInfoList"
               class="fileName"
               @click="downFiles(item)"
               :key="index">
            <template v-if="index == processForm.fileInfoList.length - 1">{{ item.fileName.substring(0, 9) }}</template>
            <template v-else>{{ item.fileName.substring(0, 9) }}
            </template>
          </div>
        </div>
      </el-form-item>
    </el-form>
```
bug1 : 暂存后，重新

### 新增根因分析报告

####  step 1  传 row，过程processList，查询根因分析报告

1. row
```js
{
    "id": "80",
    "status": "1",
    "handleId": "",
    "enterUserName": "曹鹏飞",
    "enterUserId": "txj10808245",
    "enterGroupName": "技术部",
    "enterGroupId": "465",
    "enterDate": "2024-01-29 11:21:22",
    "problemType": "2",
    "problemProp": "0",
    "appearDate": "",
    "desireDate": "2024-01-31",
    "problemName": "qwer",
    "problemDescribe": "qw4e",
    "customerId": "qqqqqq",
    "problemAppearance": "0",
    "happendDate": "",
    "customerType": "1",
    "customerContact": "qqwqeqwe",
    "customerPhone": "11111111111",
    "vin": "1111",
    "level": "3",
    "problemStatusLabel": "问题根因分析",
    "problemStatus": "3",
    "projectName": "",
    "projectId": "",
    "occuStage": "",
    "product": "天行健车联网服务系统（陕西省运营平台）",
    "productId": "177",
    "seriousDegree": "",
    "examType": "",
    "problemDeal": "",
    "receiverName": "周梦玲",
    "receiverId": "txj10808901",
    "receiveGroupName": "技术部",
    "receiveGroupId": "465",
    "fileId": "228",
    "verifyPattern": "",
    "verifyDate": "2024-01-29 11:24:31",
    "fileInfoList": [
        {
            "id": 228,
            "fileType": "jpg",
            "fileName": "1.jpg",
            "originalName": "1.jpg",
            "objectKey": "txj_ProjectManage/secondPhase/gswtk20240129112153A002.jpg",
            "fileUrl": "https://yykfb.obs.cn-north-4.myhuaweicloud.com:443/txj_ProjectManage%2FsecondPhase%2Fgswtk20240129112153A002.jpg",
            "createBy": "txj10808245",
            "createTime": "2024-01-29 11:21:54"
        }
    ]
}

```

2. processList
```js
[
    {
        "id": 101,
        "problemId": 80,
        "processId": "txj10203992",
        "processName": "陈治卫",
        "processGroupId": "466",
        "processGroupName": "营销服务部",
        "assignId": "txj10808901",
        "assignName": "周梦玲",
        "assignGroupId": "465",
        "assignGroupName": "技术部",
        "solveDate": "2024-01-29 11:22:35",
        "problemCause": "2222222",
        "problemSolution": "22222222",
        "fileId": "229",
        "fileInfoList": [
            {
                "id": 229,
                "fileType": "jpg",
                "fileName": "2.jpg",
                "originalName": "2.jpg",
                "objectKey": "txj_ProjectManage/secondPhase/gswtk20240129112307A003.jpg",
                "fileUrl": "https://yykfb.obs.cn-north-4.myhuaweicloud.com:443/txj_ProjectManage%2FsecondPhase%2Fgswtk20240129112307A003.jpg",
                "createBy": "txj10808901",
                "createTime": "2024-01-29 11:23:07"
            }
        ],
        "processNo": "1",
        "status": "1",
        "verifyStatus": "",
        "verifyPattern": null,
        "verifyDate": null, // 判断是否验证
        "nopassReason": "",
        "remark": "",
        "problemStatus": 1,
        "createUser": "周梦玲",
        "createDate": "2024-01-29 11:23:10",
        "updateUser": null,
        "updateDate": null
    },
    {
        "id": 102,
        "problemId": 80,
        "processId": "txj10808245",
        "processName": "曹鹏飞",
        "processGroupId": "465",
        "processGroupName": "技术部",
        "assignId": "txj10203992",
        "assignName": "陈治卫",
        "assignGroupId": "466",
        "assignGroupName": "营销服务部",
        "solveDate": "2024-01-29 11:23:36",
        "problemCause": "33",
        "problemSolution": "333",
        "fileId": "230",
        "fileInfoList": [
            {
                "id": 230,
                "fileType": "jpg",
                "fileName": "3.jpg",
                "originalName": "3.jpg",
                "objectKey": "txj_ProjectManage/secondPhase/gswtk20240129112357A004.jpg",
                "fileUrl": "https://yykfb.obs.cn-north-4.myhuaweicloud.com:443/txj_ProjectManage%2FsecondPhase%2Fgswtk20240129112357A004.jpg",
                "createBy": "txj10203992",
                "createTime": "2024-01-29 11:23:58"
            }
        ],
        "processNo": "2",
        "status": "1",
        "verifyStatus": "",
        "verifyPattern": null,
        "verifyDate": null,
        "nopassReason": "",
        "remark": "",
        "problemStatus": 2,
        "createUser": "陈治卫",
        "createDate": "2024-01-29 11:24:04",
        "updateUser": null,
        "updateDate": null
    },
    {
        "id": 103,
        "problemId": 80,
        "processId": "txj10808901",
        "processName": "周梦玲",
        "processGroupId": "465",
        "processGroupName": "技术部",
        "assignId": "txj10808245",
        "assignName": "曹鹏飞",
        "assignGroupId": "465",
        "assignGroupName": "技术部",
        "solveDate": null,
        "problemCause": null,
        "problemSolution": null,
        "fileId": null,
        "fileInfoList": null,
        "processNo": "3",
        "status": "1",
        "verifyStatus": "1",
        "verifyPattern": null,
        "verifyDate": "2024-01-29 11:24:31",
        "nopassReason": "",
        "remark": null,
        "problemStatus": 3,
        "createUser": "曹鹏飞",
        "createDate": "2024-01-29 11:24:38",
        "updateUser": null,
        "updateDate": null
    }
]
```

3. 查询根因分析报告 queryRootAnalysisReport

```js
// 请求参数
const query = {
        problemId: this.detailForm.id
      }
      
// 1. 初始，无暂存
{
  "msg": "操作成功",
  "code": 200,
  "data": {
    "typeName": null,
    "report": null,
    "reportInfoList": null
  }
}

// 有数据
{
    "msg": "操作成功",
    "code": 200,
    "data": {
        "typeName": "界面（APP）问题",
        "report": {
            "searchValue": null,
            "createBy": null,
            "createTime": null,
            "updateBy": null,
            "updateTime": null,
            "remark": null,
            "params": {},
            "id": 8,
            "problemId": 80,
            "processId": null,
            "typeIds": "7",
            "description": "1",
            "source": "1",
            "meetDate": "2024-01-22 00:00:00",
            "host": "txj10137610",
            "hostName": "田宇",
            "participants": "txj10133072",
            "participantNames": "孙欣欣",
            "causeAnalysis": "111",
            "auditState": null,
            "auditDate": null,
            "staging": null,
            "planFinishDate": null,
            "actualFinishDate": null,
            "infoList": [
                {
                    "searchValue": null,
                    "createBy": null,
                    "createTime": null,
                    "updateBy": null,
                    "updateTime": null,
                    "remark": null,
                    "params": {},
                    "id": 268,
                    "reportId": 8,
                    "description": "2",
                    "priority": "2",
                    "measure": "22",
                    "personId": "txj10203992",
                    "personName": "陈治卫",
                    "groupId": 508,
                    "groupName": "市场营销部",
                    "measureInfo": null,
                    "output": "22",
                    "planFinishDate": "2024-01-15 00:00:00",
                    "actualFinishDate": null,
                    "state": 0,
                    "fileIds": null,
                    "verifyDate": null,
                    "auditState": null,
                    "reason": null,
                    "fileInfos": null
                },
                {
                    "searchValue": null,
                    "createBy": null,
                    "createTime": null,
                    "updateBy": null,
                    "updateTime": null,
                    "remark": null,
                    "params": {},
                    "id": 267,
                    "reportId": 8,
                    "description": "1",
                    "priority": "1",
                    "measure": "1",
                    "personId": "txj10808245",
                    "personName": "曹鹏飞",
                    "groupId": 496,
                    "groupName": "运维管理部",
                    "measureInfo": null,
                    "output": "1",
                    "planFinishDate": "2024-01-29 00:00:00",
                    "actualFinishDate": null,
                    "state": 0,
                    "fileIds": null,
                    "verifyDate": null,
                    "auditState": null,
                    "reason": null,
                    "fileInfos": null
                }
            ],
            "url": ""
        },
        "reportInfoList": [
            {
                "searchValue": null,
                "createBy": "txj10808901",
                "createTime": "2024-01-29 14:20:54",
                "updateBy": "txj10808901",
                "updateTime": "2024-01-29 14:20:54",
                "remark": null,
                "params": {},
                "id": 268,
                "reportId": 8,
                "description": "2",
                "priority": "2",
                "measure": "22",
                "personId": "txj10203992",
                "personName": "陈治卫",
                "groupId": 508,
                "groupName": "市场营销部",
                "measureInfo": null,
                "output": "22",
                "planFinishDate": "2024-01-15 00:00:00",
                "actualFinishDate": null,
                "state": 0,
                "fileIds": null,
                "verifyDate": null,
                "auditState": null,
                "reason": null,
                "fileInfos": null
            },
            {
                "searchValue": null,
                "createBy": "txj10808901",
                "createTime": "2024-01-29 14:20:54",
                "updateBy": "txj10808901",
                "updateTime": "2024-01-29 14:20:54",
                "remark": null,
                "params": {},
                "id": 267,
                "reportId": 8,
                "description": "1",
                "priority": "1",
                "measure": "1",
                "personId": "txj10808245",
                "personName": "曹鹏飞",
                "groupId": 496,
                "groupName": "运维管理部",
                "measureInfo": null,
                "output": "1",
                "planFinishDate": "2024-01-29 00:00:00",
                "actualFinishDate": null,
                "state": 0,
                "fileIds": null,
                "verifyDate": null,
                "auditState": null,
                "reason": null,
                "fileInfos": null
            }
        ]
    }
}

```

4. 传值给根因分析报告
```html
      <ReasonAnalysisReport  @cancel="reportCancel"
                            @confirm="reportConfirm" // 自定义事件传值，传给父组件自己的 form ，新增根因分析报告要用
                            
                            :myReportForm="reportForm"  // this.reportForm = data.report ( 查询根因分析报告 queryRootAnalysisReport)
                            :problemType="detailForm.problemType" // row里的问题类型
                            :isDisabled="pageState != 1"> 
      </ReasonAnalysisReport>
```

 bug
跳转bug
1. 新建根因分析报告后，重新进入仍为根因分析报告页面 ，可新建根因分析报告，但后端回提示不可以新建
### 问题根因分析整改文件上传

- [ ] bug 1 暂存后，继续暂存，同一文件多次显示 ； 未清空回显filesList

```js

```

### 表单校验

- 新建根因分析报告
	1. 打开根因分析报告前，问题根因分类的校验
	2. 根因分析报告已经在组件内完成校验



----


